{
  "version": 3,
  "sources": ["../node_modules/webextension-polyfill/dist/browser-polyfill.js", "../src/utils/types.ts", "../src/utils/browserApi.ts", "../src/utils/github.ts", "../src/utils/utils.ts", "../src/background.ts"],
  "sourcesContent": ["/* webextension-polyfill - v0.12.0 - Tue May 14 2024 18:01:29 */\n/* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */\n/* vim: set sts=2 sw=2 et tw=80: */\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\"use strict\";\n\nif (!(globalThis.chrome && globalThis.chrome.runtime && globalThis.chrome.runtime.id)) {\n  throw new Error(\"This script should only be loaded in a browser extension.\");\n}\n\nif (!(globalThis.browser && globalThis.browser.runtime && globalThis.browser.runtime.id)) {\n  const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE = \"The message port closed before a response was received.\";\n\n  // Wrapping the bulk of this polyfill in a one-time-use function is a minor\n  // optimization for Firefox. Since Spidermonkey does not fully parse the\n  // contents of a function until the first time it's called, and since it will\n  // never actually need to be called, this allows the polyfill to be included\n  // in Firefox nearly for free.\n  const wrapAPIs = extensionAPIs => {\n    // NOTE: apiMetadata is associated to the content of the api-metadata.json file\n    // at build time by replacing the following \"include\" with the content of the\n    // JSON file.\n    const apiMetadata = {\n      \"alarms\": {\n        \"clear\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"clearAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"bookmarks\": {\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getChildren\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getRecent\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getSubTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTree\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"browserAction\": {\n        \"disable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"enable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"getBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"openPopup\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"browsingData\": {\n        \"remove\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"removeCache\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCookies\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeDownloads\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFormData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeHistory\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeLocalStorage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePasswords\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePluginData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"settings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"commands\": {\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"contextMenus\": {\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"cookies\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAllCookieStores\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"set\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"devtools\": {\n        \"inspectedWindow\": {\n          \"eval\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2,\n            \"singleCallbackArg\": false\n          }\n        },\n        \"panels\": {\n          \"create\": {\n            \"minArgs\": 3,\n            \"maxArgs\": 3,\n            \"singleCallbackArg\": true\n          },\n          \"elements\": {\n            \"createSidebarPane\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          }\n        }\n      },\n      \"downloads\": {\n        \"cancel\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"download\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"erase\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFileIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"open\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"pause\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFile\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"resume\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"extension\": {\n        \"isAllowedFileSchemeAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"isAllowedIncognitoAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"history\": {\n        \"addUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"deleteRange\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getVisits\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"i18n\": {\n        \"detectLanguage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAcceptLanguages\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"identity\": {\n        \"launchWebAuthFlow\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"idle\": {\n        \"queryState\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"management\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setEnabled\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"uninstallSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"notifications\": {\n        \"clear\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPermissionLevel\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"pageAction\": {\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"hide\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"permissions\": {\n        \"contains\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"request\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"runtime\": {\n        \"getBackgroundPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPlatformInfo\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"openOptionsPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"requestUpdateCheck\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"sendMessage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 3\n        },\n        \"sendNativeMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"setUninstallURL\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"sessions\": {\n        \"getDevices\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getRecentlyClosed\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"restore\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"storage\": {\n        \"local\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"managed\": {\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"sync\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        }\n      },\n      \"tabs\": {\n        \"captureVisibleTab\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"detectLanguage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"discard\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"duplicate\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"executeScript\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getZoom\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getZoomSettings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goBack\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goForward\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"highlight\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"insertCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"query\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"reload\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"sendMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 3\n        },\n        \"setZoom\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"setZoomSettings\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"update\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        }\n      },\n      \"topSites\": {\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"webNavigation\": {\n        \"getAllFrames\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFrame\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"webRequest\": {\n        \"handlerBehaviorChanged\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"windows\": {\n        \"create\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getLastFocused\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      }\n    };\n\n    if (Object.keys(apiMetadata).length === 0) {\n      throw new Error(\"api-metadata.json has not been included in browser-polyfill\");\n    }\n\n    /**\n     * A WeakMap subclass which creates and stores a value for any key which does\n     * not exist when accessed, but behaves exactly as an ordinary WeakMap\n     * otherwise.\n     *\n     * @param {function} createItem\n     *        A function which will be called in order to create the value for any\n     *        key which does not exist, the first time it is accessed. The\n     *        function receives, as its only argument, the key being created.\n     */\n    class DefaultWeakMap extends WeakMap {\n      constructor(createItem, items = undefined) {\n        super(items);\n        this.createItem = createItem;\n      }\n\n      get(key) {\n        if (!this.has(key)) {\n          this.set(key, this.createItem(key));\n        }\n\n        return super.get(key);\n      }\n    }\n\n    /**\n     * Returns true if the given object is an object with a `then` method, and can\n     * therefore be assumed to behave as a Promise.\n     *\n     * @param {*} value The value to test.\n     * @returns {boolean} True if the value is thenable.\n     */\n    const isThenable = value => {\n      return value && typeof value === \"object\" && typeof value.then === \"function\";\n    };\n\n    /**\n     * Creates and returns a function which, when called, will resolve or reject\n     * the given promise based on how it is called:\n     *\n     * - If, when called, `chrome.runtime.lastError` contains a non-null object,\n     *   the promise is rejected with that value.\n     * - If the function is called with exactly one argument, the promise is\n     *   resolved to that value.\n     * - Otherwise, the promise is resolved to an array containing all of the\n     *   function's arguments.\n     *\n     * @param {object} promise\n     *        An object containing the resolution and rejection functions of a\n     *        promise.\n     * @param {function} promise.resolve\n     *        The promise's resolution function.\n     * @param {function} promise.reject\n     *        The promise's rejection function.\n     * @param {object} metadata\n     *        Metadata about the wrapped method which has created the callback.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function}\n     *        The generated callback function.\n     */\n    const makeCallback = (promise, metadata) => {\n      return (...callbackArgs) => {\n        if (extensionAPIs.runtime.lastError) {\n          promise.reject(new Error(extensionAPIs.runtime.lastError.message));\n        } else if (metadata.singleCallbackArg ||\n                   (callbackArgs.length <= 1 && metadata.singleCallbackArg !== false)) {\n          promise.resolve(callbackArgs[0]);\n        } else {\n          promise.resolve(callbackArgs);\n        }\n      };\n    };\n\n    const pluralizeArguments = (numArgs) => numArgs == 1 ? \"argument\" : \"arguments\";\n\n    /**\n     * Creates a wrapper function for a method with the given name and metadata.\n     *\n     * @param {string} name\n     *        The name of the method which is being wrapped.\n     * @param {object} metadata\n     *        Metadata about the method being wrapped.\n     * @param {integer} metadata.minArgs\n     *        The minimum number of arguments which must be passed to the\n     *        function. If called with fewer than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {integer} metadata.maxArgs\n     *        The maximum number of arguments which may be passed to the\n     *        function. If called with more than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function(object, ...*)}\n     *       The generated wrapper function.\n     */\n    const wrapAsyncFunction = (name, metadata) => {\n      return function asyncFunctionWrapper(target, ...args) {\n        if (args.length < metadata.minArgs) {\n          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        if (args.length > metadata.maxArgs) {\n          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        return new Promise((resolve, reject) => {\n          if (metadata.fallbackToNoCallback) {\n            // This API method has currently no callback on Chrome, but it return a promise on Firefox,\n            // and so the polyfill will try to call it with a callback first, and it will fallback\n            // to not passing the callback if the first call fails.\n            try {\n              target[name](...args, makeCallback({resolve, reject}, metadata));\n            } catch (cbError) {\n              console.warn(`${name} API method doesn't seem to support the callback parameter, ` +\n                           \"falling back to call it without a callback: \", cbError);\n\n              target[name](...args);\n\n              // Update the API method metadata, so that the next API calls will not try to\n              // use the unsupported callback anymore.\n              metadata.fallbackToNoCallback = false;\n              metadata.noCallback = true;\n\n              resolve();\n            }\n          } else if (metadata.noCallback) {\n            target[name](...args);\n            resolve();\n          } else {\n            target[name](...args, makeCallback({resolve, reject}, metadata));\n          }\n        });\n      };\n    };\n\n    /**\n     * Wraps an existing method of the target object, so that calls to it are\n     * intercepted by the given wrapper function. The wrapper function receives,\n     * as its first argument, the original `target` object, followed by each of\n     * the arguments passed to the original method.\n     *\n     * @param {object} target\n     *        The original target object that the wrapped method belongs to.\n     * @param {function} method\n     *        The method being wrapped. This is used as the target of the Proxy\n     *        object which is created to wrap the method.\n     * @param {function} wrapper\n     *        The wrapper function which is called in place of a direct invocation\n     *        of the wrapped method.\n     *\n     * @returns {Proxy<function>}\n     *        A Proxy object for the given method, which invokes the given wrapper\n     *        method in its place.\n     */\n    const wrapMethod = (target, method, wrapper) => {\n      return new Proxy(method, {\n        apply(targetMethod, thisObj, args) {\n          return wrapper.call(thisObj, target, ...args);\n        },\n      });\n    };\n\n    let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);\n\n    /**\n     * Wraps an object in a Proxy which intercepts and wraps certain methods\n     * based on the given `wrappers` and `metadata` objects.\n     *\n     * @param {object} target\n     *        The target object to wrap.\n     *\n     * @param {object} [wrappers = {}]\n     *        An object tree containing wrapper functions for special cases. Any\n     *        function present in this object tree is called in place of the\n     *        method in the same location in the `target` object tree. These\n     *        wrapper methods are invoked as described in {@see wrapMethod}.\n     *\n     * @param {object} [metadata = {}]\n     *        An object tree containing metadata used to automatically generate\n     *        Promise-based wrapper functions for asynchronous. Any function in\n     *        the `target` object tree which has a corresponding metadata object\n     *        in the same location in the `metadata` tree is replaced with an\n     *        automatically-generated wrapper function, as described in\n     *        {@see wrapAsyncFunction}\n     *\n     * @returns {Proxy<object>}\n     */\n    const wrapObject = (target, wrappers = {}, metadata = {}) => {\n      let cache = Object.create(null);\n      let handlers = {\n        has(proxyTarget, prop) {\n          return prop in target || prop in cache;\n        },\n\n        get(proxyTarget, prop, receiver) {\n          if (prop in cache) {\n            return cache[prop];\n          }\n\n          if (!(prop in target)) {\n            return undefined;\n          }\n\n          let value = target[prop];\n\n          if (typeof value === \"function\") {\n            // This is a method on the underlying object. Check if we need to do\n            // any wrapping.\n\n            if (typeof wrappers[prop] === \"function\") {\n              // We have a special-case wrapper for this method.\n              value = wrapMethod(target, target[prop], wrappers[prop]);\n            } else if (hasOwnProperty(metadata, prop)) {\n              // This is an async method that we have metadata for. Create a\n              // Promise wrapper for it.\n              let wrapper = wrapAsyncFunction(prop, metadata[prop]);\n              value = wrapMethod(target, target[prop], wrapper);\n            } else {\n              // This is a method that we don't know or care about. Return the\n              // original method, bound to the underlying object.\n              value = value.bind(target);\n            }\n          } else if (typeof value === \"object\" && value !== null &&\n                     (hasOwnProperty(wrappers, prop) ||\n                      hasOwnProperty(metadata, prop))) {\n            // This is an object that we need to do some wrapping for the children\n            // of. Create a sub-object wrapper for it with the appropriate child\n            // metadata.\n            value = wrapObject(value, wrappers[prop], metadata[prop]);\n          } else if (hasOwnProperty(metadata, \"*\")) {\n            // Wrap all properties in * namespace.\n            value = wrapObject(value, wrappers[prop], metadata[\"*\"]);\n          } else {\n            // We don't need to do any wrapping for this property,\n            // so just forward all access to the underlying object.\n            Object.defineProperty(cache, prop, {\n              configurable: true,\n              enumerable: true,\n              get() {\n                return target[prop];\n              },\n              set(value) {\n                target[prop] = value;\n              },\n            });\n\n            return value;\n          }\n\n          cache[prop] = value;\n          return value;\n        },\n\n        set(proxyTarget, prop, value, receiver) {\n          if (prop in cache) {\n            cache[prop] = value;\n          } else {\n            target[prop] = value;\n          }\n          return true;\n        },\n\n        defineProperty(proxyTarget, prop, desc) {\n          return Reflect.defineProperty(cache, prop, desc);\n        },\n\n        deleteProperty(proxyTarget, prop) {\n          return Reflect.deleteProperty(cache, prop);\n        },\n      };\n\n      // Per contract of the Proxy API, the \"get\" proxy handler must return the\n      // original value of the target if that value is declared read-only and\n      // non-configurable. For this reason, we create an object with the\n      // prototype set to `target` instead of using `target` directly.\n      // Otherwise we cannot return a custom object for APIs that\n      // are declared read-only and non-configurable, such as `chrome.devtools`.\n      //\n      // The proxy handlers themselves will still use the original `target`\n      // instead of the `proxyTarget`, so that the methods and properties are\n      // dereferenced via the original targets.\n      let proxyTarget = Object.create(target);\n      return new Proxy(proxyTarget, handlers);\n    };\n\n    /**\n     * Creates a set of wrapper functions for an event object, which handles\n     * wrapping of listener functions that those messages are passed.\n     *\n     * A single wrapper is created for each listener function, and stored in a\n     * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`\n     * retrieve the original wrapper, so that  attempts to remove a\n     * previously-added listener work as expected.\n     *\n     * @param {DefaultWeakMap<function, function>} wrapperMap\n     *        A DefaultWeakMap object which will create the appropriate wrapper\n     *        for a given listener function when one does not exist, and retrieve\n     *        an existing one when it does.\n     *\n     * @returns {object}\n     */\n    const wrapEvent = wrapperMap => ({\n      addListener(target, listener, ...args) {\n        target.addListener(wrapperMap.get(listener), ...args);\n      },\n\n      hasListener(target, listener) {\n        return target.hasListener(wrapperMap.get(listener));\n      },\n\n      removeListener(target, listener) {\n        target.removeListener(wrapperMap.get(listener));\n      },\n    });\n\n    const onRequestFinishedWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps an onRequestFinished listener function so that it will return a\n       * `getContent()` property which returns a `Promise` rather than using a\n       * callback API.\n       *\n       * @param {object} req\n       *        The HAR entry object representing the network request.\n       */\n      return function onRequestFinished(req) {\n        const wrappedReq = wrapObject(req, {} /* wrappers */, {\n          getContent: {\n            minArgs: 0,\n            maxArgs: 0,\n          },\n        });\n        listener(wrappedReq);\n      };\n    });\n\n    const onMessageWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps a message listener function so that it may send responses based on\n       * its return value, rather than by returning a sentinel value and calling a\n       * callback. If the listener function returns a Promise, the response is\n       * sent when the promise either resolves or rejects.\n       *\n       * @param {*} message\n       *        The message sent by the other end of the channel.\n       * @param {object} sender\n       *        Details about the sender of the message.\n       * @param {function(*)} sendResponse\n       *        A callback which, when called with an arbitrary argument, sends\n       *        that value as a response.\n       * @returns {boolean}\n       *        True if the wrapped listener returned a Promise, which will later\n       *        yield a response. False otherwise.\n       */\n      return function onMessage(message, sender, sendResponse) {\n        let didCallSendResponse = false;\n\n        let wrappedSendResponse;\n        let sendResponsePromise = new Promise(resolve => {\n          wrappedSendResponse = function(response) {\n            didCallSendResponse = true;\n            resolve(response);\n          };\n        });\n\n        let result;\n        try {\n          result = listener(message, sender, wrappedSendResponse);\n        } catch (err) {\n          result = Promise.reject(err);\n        }\n\n        const isResultThenable = result !== true && isThenable(result);\n\n        // If the listener didn't returned true or a Promise, or called\n        // wrappedSendResponse synchronously, we can exit earlier\n        // because there will be no response sent from this listener.\n        if (result !== true && !isResultThenable && !didCallSendResponse) {\n          return false;\n        }\n\n        // A small helper to send the message if the promise resolves\n        // and an error if the promise rejects (a wrapped sendMessage has\n        // to translate the message into a resolved promise or a rejected\n        // promise).\n        const sendPromisedResult = (promise) => {\n          promise.then(msg => {\n            // send the message value.\n            sendResponse(msg);\n          }, error => {\n            // Send a JSON representation of the error if the rejected value\n            // is an instance of error, or the object itself otherwise.\n            let message;\n            if (error && (error instanceof Error ||\n                typeof error.message === \"string\")) {\n              message = error.message;\n            } else {\n              message = \"An unexpected error occurred\";\n            }\n\n            sendResponse({\n              __mozWebExtensionPolyfillReject__: true,\n              message,\n            });\n          }).catch(err => {\n            // Print an error on the console if unable to send the response.\n            console.error(\"Failed to send onMessage rejected reply\", err);\n          });\n        };\n\n        // If the listener returned a Promise, send the resolved value as a\n        // result, otherwise wait the promise related to the wrappedSendResponse\n        // callback to resolve and send it as a response.\n        if (isResultThenable) {\n          sendPromisedResult(result);\n        } else {\n          sendPromisedResult(sendResponsePromise);\n        }\n\n        // Let Chrome know that the listener is replying.\n        return true;\n      };\n    });\n\n    const wrappedSendMessageCallback = ({reject, resolve}, reply) => {\n      if (extensionAPIs.runtime.lastError) {\n        // Detect when none of the listeners replied to the sendMessage call and resolve\n        // the promise to undefined as in Firefox.\n        // See https://github.com/mozilla/webextension-polyfill/issues/130\n        if (extensionAPIs.runtime.lastError.message === CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE) {\n          resolve();\n        } else {\n          reject(new Error(extensionAPIs.runtime.lastError.message));\n        }\n      } else if (reply && reply.__mozWebExtensionPolyfillReject__) {\n        // Convert back the JSON representation of the error into\n        // an Error instance.\n        reject(new Error(reply.message));\n      } else {\n        resolve(reply);\n      }\n    };\n\n    const wrappedSendMessage = (name, metadata, apiNamespaceObj, ...args) => {\n      if (args.length < metadata.minArgs) {\n        throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      if (args.length > metadata.maxArgs) {\n        throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      return new Promise((resolve, reject) => {\n        const wrappedCb = wrappedSendMessageCallback.bind(null, {resolve, reject});\n        args.push(wrappedCb);\n        apiNamespaceObj.sendMessage(...args);\n      });\n    };\n\n    const staticWrappers = {\n      devtools: {\n        network: {\n          onRequestFinished: wrapEvent(onRequestFinishedWrappers),\n        },\n      },\n      runtime: {\n        onMessage: wrapEvent(onMessageWrappers),\n        onMessageExternal: wrapEvent(onMessageWrappers),\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 1, maxArgs: 3}),\n      },\n      tabs: {\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 2, maxArgs: 3}),\n      },\n    };\n    const settingMetadata = {\n      clear: {minArgs: 1, maxArgs: 1},\n      get: {minArgs: 1, maxArgs: 1},\n      set: {minArgs: 1, maxArgs: 1},\n    };\n    apiMetadata.privacy = {\n      network: {\"*\": settingMetadata},\n      services: {\"*\": settingMetadata},\n      websites: {\"*\": settingMetadata},\n    };\n\n    return wrapObject(extensionAPIs, staticWrappers, apiMetadata);\n  };\n\n  // The build process adds a UMD wrapper around this file, which makes the\n  // `module` variable available.\n  module.exports = wrapAPIs(chrome);\n} else {\n  module.exports = globalThis.browser;\n}\n", "/// <reference types=\"chrome\"/>\nimport { CSSProperties } from \"react\";\n\nexport interface Position {\n    x: number;\n    y: number;\n}\n\nexport interface Bookmark {\n    id: string;\n    url: string;\n    name: string;\n    position?: Position;\n    icon: string;\n}\n\nexport interface WidgetConfig {\n    id: string;\n    name: string;\n    position: Position;\n    icon?: string;\n    enabled: boolean;\n}\n\nexport interface GitHubSyncSettings {\n    lastSync: number | null;\n    autoSync: boolean;\n    publicGist: boolean;\n    tokenSaved: boolean;\n    gistId: string | undefined;\n}\n\nexport interface Settings {\n    bgColor: string;\n    bgUrl?: string;\n    githubSync: GitHubSyncSettings;\n    bookmarks?: Bookmark[];\n    widgetConfigs: Record<string, WidgetConfig>;\n}\n\nexport interface SettingsContextType {\n    settings: Settings | null;\n    setSettings: (s: Settings) => void;\n    addBookmark: (s: Bookmark) => Promise<void>;\n    updateBookmark: (s: string, bm: Partial<Bookmark>) => Promise<void>;\n    removeBookmark: (s: string) => Promise<void>;\n    getBookmarkById: (s: string) => Bookmark | undefined;\n    updateWidgetPosition: (id: string, newPos: Position) => Promise<void>;\n    enableDisableWidget: (id: string, enabled: boolean) => Promise<void>;\n    updateGithubSettings: (s: Partial<GitHubSyncSettings>) => Promise<void>;\n    updateAndPersistSettings: (s: Partial<Settings>) => Promise<void>;\n}\n\nexport interface SettingsButtonProps {\n    openSettingsPanel: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nexport interface AddBookmarkButtonProps {\n    showBookmarkForm: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nexport interface BookmarkFormProps {\n    bookmarkId?: string;\n    initialData?: Partial<Bookmark>;\n    mode: \"add\" | \"edit\";\n    onCancel: React.Dispatch<React.SetStateAction<boolean>>;\n    showBookmarkForm: boolean;\n}\n\nexport interface WidgetProps {\n    config: WidgetConfig;\n}\n\nexport interface FoldableSectionProps {\n    title: React.ReactNode;\n    icon?: React.ReactNode;\n    children: React.ReactNode;\n    defaultOpen?: boolean;\n}\n\nexport type IconProps = React.FC<{ style?: CSSProperties }>;\n\nexport interface ColorResult {\n    hex: string;\n    rgb: { r: number; g: number; b: number };\n}\n\nexport interface PopUpMenuProps {\n    wrapperRef: React.RefObject<HTMLDivElement | null>;\n    menuOpen: boolean;\n    setMenuOpen: React.Dispatch<React.SetStateAction<boolean>>;\n    id: string;\n    onEdit?: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\ninterface Runtime {\n    sendMessage: (message: any, callback: (response?: any) => void) => void;\n    lastError?: { message: string };\n}\n\ninterface Storage {\n    local: {\n        set: (items: Record<string, any>) => void;\n        get: (key: string) => Promise<Record<string, any>>;\n        remove: (key: string) => Promise<void>;\n    };\n}\n\nexport interface BrowserAPI {\n    runtime: Runtime;\n    storage: Storage;\n}\n\n// Cast window to an extended type that optionally has browser and chrome\nexport const typedWindow = window as typeof window & {\n    browser?: BrowserAPI;\n    chrome?: BrowserAPI;\n};\n\nexport interface GithubDeviceCodeResponse {\n    device_code: string;\n    user_code: string;\n    verification_uri: string;\n    expires_in: number;\n    interval: number;\n}\n\nexport interface GithubTokenResponse {\n    access_token?: string;\n    token_type?: string;\n    scope?: string;\n    error?: string;\n    error_description?: string;\n    error_uri?: string;\n}\n\nexport interface GitHubDeviceFlowStartMessage {\n    type: \"GITHUB_DEVICE_FLOW\";\n    action: \"startDeviceFlow\";\n}\n\nexport interface GitHubDeviceFlowTokenMessage {\n    type: \"GITHUB_DEVICE_FLOW\";\n    action: \"getToken\";\n    device_code: string;\n}\n\nexport interface GitHubAPIMessage {\n    type: \"GITHUB_GIST_API\";\n    action: \"findGist\" | \"createOrUpdateLooiGist\";\n    gistId?: string;\n    payload: Settings;\n}\n\nexport interface GistFile {\n    filename: string;\n    type: string;\n    language: string;\n    raw_url: string;\n    size: number;\n    truncated: boolean;\n    content?: string;\n    encoding: string;\n}\n\nexport interface GithubAPIResponse {\n    gistId: string;\n    url: string;\n    public: boolean;\n    settings: Settings;\n}\n\nexport interface GitHubAPIResponseMessage {\n    type: \"GITHUB_GIST_API\";\n    action: \"findGist\" | \"createOrUpdateLooiGist\";\n    gistId: string;\n}\n\nexport type MessageData =\n    | GitHubDeviceFlowStartMessage\n    | GitHubDeviceFlowTokenMessage\n    | GitHubAPIMessage;\n\nexport interface GithubResponses {\n    success: boolean;\n    data?: GithubDeviceCodeResponse | GithubTokenResponse | GithubAPIResponse;\n    error?: string;\n}\n\nexport interface BackgroundResponse<T = unknown> {\n    success: boolean;\n    data?: T;\n    error?: string;\n}\n\nexport interface DeviceFlowAuthProps {\n    onTokenReceived: (token: string) => void;\n}\n\nexport type SyncStatus = \"idle\" | \"syncing\" | \"success\" | \"error\";\n\n\nexport interface GistResponse {\n    url: string;\n    id: string;\n    files: Record<string, GistFile>;\n    public: boolean;\n}\n", "import { typedWindow, BrowserAPI } from \"./types\";\n\nexport let browser: typeof import(\"webextension-polyfill\") | null = null;\nexport const ext: BrowserAPI | undefined =\n  typedWindow.browser || typedWindow.chrome;\n\ntry {\n  browser = require(\"webextension-polyfill\");\n} catch {\n  // eslint-disable-next-line no-undef\n  console.warn(\n    \"webextension-polyfill is not available \u2014 running in non-extension env?\",\n  );\n}\n\nexport const isExtensionEnv = () => !!browser;\nexport const isFirefox = () =>\n  isExtensionEnv() &&\n  browser?.runtime.getBrowserInfo().then((info) => info.name === \"Firefox\");\nexport const isChrome = () =>\n  isExtensionEnv() &&\n  browser?.runtime.getBrowserInfo().then((info) => info.name === \"Chrome\");\nexport const isEdge = () =>\n  isExtensionEnv() &&\n  browser?.runtime\n    .getBrowserInfo()\n    .then((info) => info.name === \"Microsoft Edge\");\n", "import {\n    GithubDeviceCodeResponse,\n    GithubTokenResponse,\n    MessageData,\n    BackgroundResponse,\n    GithubAPIResponse,\n    Settings,\n} from \"./types\";\n\nimport { ext } from \"./browserApi\";\n\nexport const startDeviceFlow = (\n    setLoading: React.Dispatch<React.SetStateAction<boolean>>,\n    setError: React.Dispatch<React.SetStateAction<string | null>>,\n    setDeviceData: React.Dispatch<\n        React.SetStateAction<GithubDeviceCodeResponse | undefined>\n    >,\n    setdataReceived: React.Dispatch<React.SetStateAction<boolean>>,\n    setStarted: React.Dispatch<React.SetStateAction<boolean>>,\n): Promise<GithubDeviceCodeResponse> => {\n    return new Promise((resolve, reject) => {\n        setLoading(false);\n        const message: MessageData = {\n            type: \"GITHUB_DEVICE_FLOW\",\n            action: \"startDeviceFlow\",\n        };\n        ext?.runtime.sendMessage(\n            message,\n            (response: BackgroundResponse<GithubDeviceCodeResponse> | undefined) => {\n                if (ext?.runtime.lastError) {\n                    reject(new Error(ext.runtime.lastError.message));\n                    return;\n                }\n\n                if (response?.success && response.data) {\n                    setDeviceData(response.data);\n                    setdataReceived(true);\n                    setStarted(true);\n                    resolve(response.data);\n                } else {\n                    setError(response?.error || \"Failed to start GitHub Device Flow.\");\n                    reject(new Error(response?.error ?? \"Unknown background error\"));\n                }\n            },\n        );\n    });\n};\n\nexport const pollForToken = (\n    device_code: string,\n    tries: number,\n    interval: number,\n    intervalId: NodeJS.Timeout | null = null,\n    setPolling: React.Dispatch<React.SetStateAction<boolean>>,\n    setError: React.Dispatch<React.SetStateAction<string | null>>,\n    setSuccess: React.Dispatch<React.SetStateAction<boolean>>,\n    setdataReceived: React.Dispatch<React.SetStateAction<boolean>>,\n    onToken: (token: string) => void,\n    pollToken: () => void,\n) => {\n    const message: MessageData = {\n        type: \"GITHUB_DEVICE_FLOW\",\n        action: \"getToken\",\n        device_code: device_code,\n    };\n    ext?.runtime.sendMessage(\n        message,\n        (response: BackgroundResponse<GithubTokenResponse> | undefined) => {\n            if (response?.success && response.data) {\n                const data = response.data;\n                if (data.access_token) {\n                    setPolling(false);\n                    setSuccess(true);\n                    setdataReceived(false);\n                    onToken(data.access_token);\n                    return;\n                } else if (data.error === \"authorization_pending\") {\n                    tries++;\n                    // Try again after interval\n                    if (intervalId) clearTimeout(intervalId);\n                    intervalId = setTimeout(pollToken, interval * 1000);\n                } else if (data.error === \"slow_down\") {\n                    interval += 5;\n                    tries++;\n                    if (intervalId) clearTimeout(intervalId);\n                    intervalId = setTimeout(pollToken, interval * 1000);\n                } else {\n                    setPolling(false);\n                    setError(data.error_description ?? \"Authorization error\");\n                }\n            } else {\n                setPolling(false);\n                setError(response?.error || \"Failed to poll token\");\n            }\n        },\n    );\n};\n\nexport const findGist = (gistId: string,\n    payload: Settings,): Promise<GithubAPIResponse> => {\n    return new Promise((resolve, reject) => {\n        const message: MessageData = {\n            type: \"GITHUB_GIST_API\",\n            action: \"findGist\",\n            gistId,\n            payload,\n        };\n        ext?.runtime.sendMessage(\n            message,\n            (response: BackgroundResponse<GithubAPIResponse> | undefined) => {\n                if (ext?.runtime.lastError) {\n                    reject(new Error(ext.runtime.lastError.message));\n                    return;\n                }\n\n                if (response?.success && response.data) {\n                    resolve(response.data);\n                } else {\n                    reject(new Error(response?.error ?? \"Unknown background error\"));\n                }\n            },\n        );\n    });\n};\n\nexport const createOrUpdateLooiGist = (\n    gistId: string | undefined,\n    payload: Settings,\n): Promise<GithubAPIResponse> => {\n    return new Promise((resolve, reject) => {\n        const message: MessageData = {\n            type: \"GITHUB_GIST_API\",\n            action: \"createOrUpdateLooiGist\",\n            gistId,\n            payload,\n        };\n        ext?.runtime.sendMessage(\n            message,\n            (response: BackgroundResponse<GithubAPIResponse> | undefined) => {\n                if (ext?.runtime.lastError) {\n                    reject(new Error(ext.runtime.lastError.message));\n                    return;\n                }\n\n                if (response?.success && response.data) {\n                    resolve(response.data);\n                } else {\n                    reject(new Error(response?.error ?? \"Unknown background error\"));\n                }\n            },\n        );\n    });\n};\n\nexport const saveToken = (token: string) => {\n    ext?.storage.local.set({ github_token: token });\n};\n\nexport const getToken = async (): Promise<string> => {\n    const stored = await ext?.storage.local.get(\"github_token\");\n    return stored?.github_token as Promise<string>;\n};\n\nexport const removeToken = async () => {\n    await ext?.storage.local.remove(\"github_token\");\n};\n", "import { Settings } from \"./types\";\n\nexport const capitalize = (s: string): string => {\n    return s.charAt(0).toUpperCase() + s.slice(1);\n};\n\nexport const removeProtocol = (url: string): string => {\n    return url.replace(\"http://\", \"\").replace(\"https://\", \"\");\n};\n\nexport const settingsToJSONString = (settings: Settings): string => {\n    return JSON.stringify(settings, null, 2); // pretty-print with 2-space indent\n}\n", "/* eslint-disable no-unused-vars */\n/* eslint-disable no-undef */\n\n/// <reference types=\"chrome\"/>\nimport type { Runtime } from \"webextension-polyfill\";\nimport { isFirefox } from \"./utils/browserApi\";\nimport {\n    GithubResponses,\n    MessageData,\n    GithubDeviceCodeResponse,\n    GithubTokenResponse,\n    GithubAPIResponse,\n    Settings,\n    GistResponse,\n} from \"./utils/types\";\nimport { getToken } from \"./utils/github\";\nimport { settingsToJSONString } from \"./utils/utils\";\n\nconst ext = isFirefox() ? browser : chrome;\n\nconst CLIENT_ID = \"Iv23li5frjjDBAV3DfuR\";\n\nconst DeviceBaseFlowURL = \"https://github.com/login/\";\nconst GistBaseURL = \"https://api.github.com/gists\";\n\next.runtime.onMessage.addListener(\n    (\n        message: MessageData,\n        _sender: Runtime.MessageSender,\n        sendResponse: (response: GithubResponses) => void,\n    ): boolean | void => {\n        if (message.type === \"GITHUB_DEVICE_FLOW\") {\n            void (async () => {\n                try {\n                    if (message.action === \"startDeviceFlow\") {\n                        // Step 1: Get device/user code\n                        const resp = await fetch(`${DeviceBaseFlowURL}device/code`, {\n                            method: \"POST\",\n                            headers: {\n                                \"Content-Type\": \"application/x-www-form-urlencoded\",\n                                Accept: \"application/json\",\n                            },\n                            body: `client_id=${encodeURIComponent(CLIENT_ID)}&scope=gist`,\n                        });\n\n                        if (!resp.ok) {\n                            throw new Error(`HTTP error! status: ${resp.status}`);\n                        }\n\n                        const data: GithubDeviceCodeResponse = await resp.json();\n                        sendResponse({ success: true, data });\n                    } else if (message.action === \"getToken\") {\n                        // Step 2: Poll for access token\n                        const resp = await fetch(\n                            `${DeviceBaseFlowURL}/oauth/access_token`,\n                            {\n                                method: \"POST\",\n                                headers: {\n                                    \"Content-Type\": \"application/x-www-form-urlencoded\",\n                                    Accept: \"application/json\",\n                                },\n                                body: `client_id=${encodeURIComponent(\n                                    CLIENT_ID,\n                                )}&device_code=${encodeURIComponent(\n                                    message.device_code,\n                                )}&grant_type=urn:ietf:params:oauth:grant-type:device_code`,\n                            },\n                        );\n\n                        if (!resp.ok) {\n                            throw new Error(`HTTP error! status: ${resp.status}`);\n                        }\n\n                        const data: GithubTokenResponse = await resp.json();\n                        sendResponse({ success: true, data });\n                    }\n                } catch (error) {\n                    sendResponse({\n                        success: false,\n                        error: error instanceof Error ? error.message : String(error),\n                    });\n                }\n            })();\n\n            // Required for async sendResponse\n            return true;\n        }\n        if (message.type === \"GITHUB_GIST_API\") {\n            (async () => {\n                const token = await getToken();\n                console.log(\"token\", token);\n                const { action, gistId, payload } = message;\n                const apiUrl = gistId\n                    ? `${GistBaseURL}/${gistId}`\n                    : GistBaseURL;\n                const headers = {\n                    \"Authorization\": `Bearer ${token}`,\n                    \"Accept\": \"application/vnd.github+json\",\n                    \"Content-Type\": \"application/json\"\n                };\n\n                if (action === \"findGist\") {\n                    const resp = await fetch(apiUrl, {\n                        headers: headers\n                    });\n                    if (!resp.ok) throw new Error(\"Failed to fetch gist\");\n                    const response: GistResponse = await resp.json();\n                    const content = response.files[\"settings.json\"].content as string;\n                    const settings = JSON.parse(content) as Settings;\n                    settings.githubSync.gistId = response.id;\n                    const data: GithubAPIResponse = {\n                        gistId: response.id,\n                        url: response.url,\n                        public: response.public,\n                        settings: settings,\n                    };\n                    sendResponse({ success: true, data: data || null });\n                }\n                else if (action === \"createOrUpdateLooiGist\") {\n                    const body = {\n                        description: \"Settings for looi extension\",\n                        public: payload.githubSync.publicGist,\n                        files: {\n                            \"settings.json\": {\n                                content: settingsToJSONString(payload)\n                            }\n                        }\n                    };\n                    const resp = await fetch(apiUrl, {\n                        method: gistId ? \"PATCH\" : \"POST\",\n                        headers: headers,\n                        body: JSON.stringify(body)\n                    });\n\n                    if (!resp.ok) {\n                        throw new Error(`GitHub API error: ${resp.status} ${resp.statusText}`);\n                    }\n\n                    const response: GistResponse = await resp.json();\n                    console.log(\"response\", response);\n                    const content = response.files[\"settings.json\"].content as string;\n                    const settings = JSON.parse(content) as Settings;\n                    settings.githubSync.gistId = response.id;\n                    const data: GithubAPIResponse = {\n                        gistId: response.id,\n                        url: response.url,\n                        public: response.public,\n                        settings: settings,\n                    };\n                    sendResponse({ success: resp.ok, data });\n                }\n            })().catch((err) => {\n                sendResponse({\n                    success: false,\n                    error: err instanceof Error ? err.message : String(err),\n                });\n            }\n\n            );\n            return true;\n        }\n        return undefined;\n    },\n);\n"],
  "mappings": "wVAMA,aAEA,GAAI,EAAEA,WAAWC,QAAUD,WAAWC,OAAOC,SAAWF,WAAWC,OAAOC,QAAQC,IAChF,MAAM,IAAIC,MAAM,2DAA2D,EAG7E,GAAMJ,WAAWK,SAAWL,WAAWK,QAAQH,SAAWF,WAAWK,QAAQH,QAAQC,GAirCnFG,EAAOC,QAAUP,WAAWK,YAjrC4D,CACxF,IAAMG,EAAmD,0DAOnDC,EAAWC,GAAiB,CAIhC,IAAMC,EAAc,CAClB,OAAU,CACR,MAAS,CACP,QAAW,EACX,QAAW,CACb,EACA,SAAY,CACV,QAAW,EACX,QAAW,CACb,EACA,IAAO,CACL,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,CACF,EACA,UAAa,CACX,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,IAAO,CACL,QAAW,EACX,QAAW,CACb,EACA,YAAe,CACb,QAAW,EACX,QAAW,CACb,EACA,UAAa,CACX,QAAW,EACX,QAAW,CACb,EACA,WAAc,CACZ,QAAW,EACX,QAAW,CACb,EACA,QAAW,CACT,QAAW,EACX,QAAW,CACb,EACA,KAAQ,CACN,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,WAAc,CACZ,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,CACF,EACA,cAAiB,CACf,QAAW,CACT,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,EACA,OAAU,CACR,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,EACA,wBAA2B,CACzB,QAAW,EACX,QAAW,CACb,EACA,aAAgB,CACd,QAAW,EACX,QAAW,CACb,EACA,SAAY,CACV,QAAW,EACX,QAAW,CACb,EACA,SAAY,CACV,QAAW,EACX,QAAW,CACb,EACA,UAAa,CACX,QAAW,EACX,QAAW,CACb,EACA,wBAA2B,CACzB,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,EACA,aAAgB,CACd,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,EACA,QAAW,CACT,QAAW,EACX,QAAW,CACb,EACA,SAAY,CACV,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,EACA,SAAY,CACV,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,CACF,EACA,aAAgB,CACd,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,YAAe,CACb,QAAW,EACX,QAAW,CACb,EACA,cAAiB,CACf,QAAW,EACX,QAAW,CACb,EACA,gBAAmB,CACjB,QAAW,EACX,QAAW,CACb,EACA,eAAkB,CAChB,QAAW,EACX,QAAW,CACb,EACA,cAAiB,CACf,QAAW,EACX,QAAW,CACb,EACA,mBAAsB,CACpB,QAAW,EACX,QAAW,CACb,EACA,gBAAmB,CACjB,QAAW,EACX,QAAW,CACb,EACA,iBAAoB,CAClB,QAAW,EACX,QAAW,CACb,EACA,SAAY,CACV,QAAW,EACX,QAAW,CACb,CACF,EACA,SAAY,CACV,OAAU,CACR,QAAW,EACX,QAAW,CACb,CACF,EACA,aAAgB,CACd,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,UAAa,CACX,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,CACF,EACA,QAAW,CACT,IAAO,CACL,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,mBAAsB,CACpB,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,IAAO,CACL,QAAW,EACX,QAAW,CACb,CACF,EACA,SAAY,CACV,gBAAmB,CACjB,KAAQ,CACN,QAAW,EACX,QAAW,EACX,kBAAqB,EACvB,CACF,EACA,OAAU,CACR,OAAU,CACR,QAAW,EACX,QAAW,EACX,kBAAqB,EACvB,EACA,SAAY,CACV,kBAAqB,CACnB,QAAW,EACX,QAAW,CACb,CACF,CACF,CACF,EACA,UAAa,CACX,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,SAAY,CACV,QAAW,EACX,QAAW,CACb,EACA,MAAS,CACP,QAAW,EACX,QAAW,CACb,EACA,YAAe,CACb,QAAW,EACX,QAAW,CACb,EACA,KAAQ,CACN,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,EACA,MAAS,CACP,QAAW,EACX,QAAW,CACb,EACA,WAAc,CACZ,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,KAAQ,CACN,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,CACF,EACA,UAAa,CACX,0BAA6B,CAC3B,QAAW,EACX,QAAW,CACb,EACA,yBAA4B,CAC1B,QAAW,EACX,QAAW,CACb,CACF,EACA,QAAW,CACT,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,UAAa,CACX,QAAW,EACX,QAAW,CACb,EACA,YAAe,CACb,QAAW,EACX,QAAW,CACb,EACA,UAAa,CACX,QAAW,EACX,QAAW,CACb,EACA,UAAa,CACX,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,CACF,EACA,KAAQ,CACN,eAAkB,CAChB,QAAW,EACX,QAAW,CACb,EACA,mBAAsB,CACpB,QAAW,EACX,QAAW,CACb,CACF,EACA,SAAY,CACV,kBAAqB,CACnB,QAAW,EACX,QAAW,CACb,CACF,EACA,KAAQ,CACN,WAAc,CACZ,QAAW,EACX,QAAW,CACb,CACF,EACA,WAAc,CACZ,IAAO,CACL,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,QAAW,CACT,QAAW,EACX,QAAW,CACb,EACA,WAAc,CACZ,QAAW,EACX,QAAW,CACb,EACA,cAAiB,CACf,QAAW,EACX,QAAW,CACb,CACF,EACA,cAAiB,CACf,MAAS,CACP,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,mBAAsB,CACpB,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,CACF,EACA,WAAc,CACZ,SAAY,CACV,QAAW,EACX,QAAW,CACb,EACA,SAAY,CACV,QAAW,EACX,QAAW,CACb,EACA,KAAQ,CACN,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,EACA,QAAW,CACT,QAAW,EACX,QAAW,CACb,EACA,SAAY,CACV,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,EACA,SAAY,CACV,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,EACA,KAAQ,CACN,QAAW,EACX,QAAW,EACX,qBAAwB,EAC1B,CACF,EACA,YAAe,CACb,SAAY,CACV,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,QAAW,CACT,QAAW,EACX,QAAW,CACb,CACF,EACA,QAAW,CACT,kBAAqB,CACnB,QAAW,EACX,QAAW,CACb,EACA,gBAAmB,CACjB,QAAW,EACX,QAAW,CACb,EACA,gBAAmB,CACjB,QAAW,EACX,QAAW,CACb,EACA,mBAAsB,CACpB,QAAW,EACX,QAAW,CACb,EACA,YAAe,CACb,QAAW,EACX,QAAW,CACb,EACA,kBAAqB,CACnB,QAAW,EACX,QAAW,CACb,EACA,gBAAmB,CACjB,QAAW,EACX,QAAW,CACb,CACF,EACA,SAAY,CACV,WAAc,CACZ,QAAW,EACX,QAAW,CACb,EACA,kBAAqB,CACnB,QAAW,EACX,QAAW,CACb,EACA,QAAW,CACT,QAAW,EACX,QAAW,CACb,CACF,EACA,QAAW,CACT,MAAS,CACP,MAAS,CACP,QAAW,EACX,QAAW,CACb,EACA,IAAO,CACL,QAAW,EACX,QAAW,CACb,EACA,cAAiB,CACf,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,IAAO,CACL,QAAW,EACX,QAAW,CACb,CACF,EACA,QAAW,CACT,IAAO,CACL,QAAW,EACX,QAAW,CACb,EACA,cAAiB,CACf,QAAW,EACX,QAAW,CACb,CACF,EACA,KAAQ,CACN,MAAS,CACP,QAAW,EACX,QAAW,CACb,EACA,IAAO,CACL,QAAW,EACX,QAAW,CACb,EACA,cAAiB,CACf,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,IAAO,CACL,QAAW,EACX,QAAW,CACb,CACF,CACF,EACA,KAAQ,CACN,kBAAqB,CACnB,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,eAAkB,CAChB,QAAW,EACX,QAAW,CACb,EACA,QAAW,CACT,QAAW,EACX,QAAW,CACb,EACA,UAAa,CACX,QAAW,EACX,QAAW,CACb,EACA,cAAiB,CACf,QAAW,EACX,QAAW,CACb,EACA,IAAO,CACL,QAAW,EACX,QAAW,CACb,EACA,WAAc,CACZ,QAAW,EACX,QAAW,CACb,EACA,QAAW,CACT,QAAW,EACX,QAAW,CACb,EACA,gBAAmB,CACjB,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,UAAa,CACX,QAAW,EACX,QAAW,CACb,EACA,UAAa,CACX,QAAW,EACX,QAAW,CACb,EACA,UAAa,CACX,QAAW,EACX,QAAW,CACb,EACA,KAAQ,CACN,QAAW,EACX,QAAW,CACb,EACA,MAAS,CACP,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,UAAa,CACX,QAAW,EACX,QAAW,CACb,EACA,YAAe,CACb,QAAW,EACX,QAAW,CACb,EACA,QAAW,CACT,QAAW,EACX,QAAW,CACb,EACA,gBAAmB,CACjB,QAAW,EACX,QAAW,CACb,EACA,OAAU,CACR,QAAW,EACX,QAAW,CACb,CACF,EACA,SAAY,CACV,IAAO,CACL,QAAW,EACX,QAAW,CACb,CACF,EACA,cAAiB,CACf,aAAgB,CACd,QAAW,EACX,QAAW,CACb,EACA,SAAY,CACV,QAAW,EACX,QAAW,CACb,CACF,EACA,WAAc,CACZ,uBAA0B,CACxB,QAAW,EACX,QAAW,CACb,CACF,EACA,QAAW,CACT,OAAU,CACR,QAAW,EACX,QAAW,CACb,EACA,IAAO,CACL,QAAW,EACX,QA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",
  "names": ["globalThis", "chrome", "runtime", "id", "Error", "browser", "module", "exports", "CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE", "wrapAPIs", "extensionAPIs", "apiMetadata", "Object", "keys", "length", "DefaultWeakMap", "WeakMap", "constructor", "createItem", "items", "undefined", "get", "key", "has", "set", "isThenable", "value", "then", "makeCallback", "promise", "metadata", "callbackArgs", "lastError", "reject", "message", "singleCallbackArg", "resolve", "pluralizeArguments", "numArgs", "wrapAsyncFunction", "name", "target", "args", "minArgs", "maxArgs", "Promise", "fallbackToNoCallback", "cbError", "console", "warn", "noCallback", "wrapMethod", "method", "wrapper", "Proxy", "apply", "targetMethod", "thisObj", "call", "hasOwnProperty", "Function", "bind", "prototype", "wrapObject", "wrappers", "cache", "create", "handlers", "proxyTarget", "prop", "receiver", "defineProperty", "configurable", "enumerable", "desc", "Reflect", "deleteProperty", "wrapEvent", "wrapperMap", "addListener", "listener", "hasListener", "removeListener", "onRequestFinishedWrappers", "req", "wrappedReq", "getContent", "onMessageWrappers", "sender", "sendResponse", "didCallSendResponse", "wrappedSendResponse", "sendResponsePromise", "response", "result", "err", "isResultThenable", "sendPromisedResult", "msg", "error", "__mozWebExtensionPolyfillReject__", "catch", "wrappedSendMessageCallback", "reply", "wrappedSendMessage", "apiNamespaceObj", "wrappedCb", "push", "sendMessage", "staticWrappers", "devtools", "network", "onRequestFinished", "onMessage", "onMessageExternal", "tabs", "settingMetadata", "clear", "privacy", "services", "websites", "typedWindow", "browser", "ext", "typedWindow", "isExtensionEnv", "isFirefox", "info", "getToken", "ext", "settingsToJSONString", "settings", "ext", "isFirefox", "CLIENT_ID", "DeviceBaseFlowURL", "GistBaseURL", "message", "_sender", "sendResponse", "resp", "data", "error", "token", "getToken", "action", "gistId", "payload", "apiUrl", "headers", "response", "content", "settings", "body", "settingsToJSONString", "err"]
}
